clear;
% close all;

delay_sum=zeros(8,3);
expected_delay=zeros(8,1);
delay_sum1=zeros(8,3);
expected_delay1=zeros(8,1);

%************************最优时延，总是保持一致规律，是否合理？需改进**********************************
%SMDP
% lambda_f =10   u_f = 10   ut=25
% count_prob =[0.375000000000000,0.350000000000000,0.150000000000000,0.125000000000000;0.349206349206349,0.301587301587302,0.158730158730159,0.190476190476190;0.319148936170213,0.276595744680851,0.159574468085106,0.244680851063830;0.296296296296296,0.251851851851852,0.162962962962963,0.288888888888889;0.276595744680851,0.234042553191489,0.159574468085106,0.329787234042553;0.258823529411765,0.219607843137255,0.188235294117647,0.333333333333333;0.242603550295858,0.207100591715976,0.298816568047337,0.251479289940828;0.229545454545455,0.195454545454545,0.381818181818182,0.193181818181818];
% lambda_f =10   u_f = 10   ut=50
count_prob =[0.375000000000000,0.350000000000000,0.125000000000000,0.150000000000000;0.349206349206349,0.301587301587302,0.142857142857143,0.206349206349206;0.319148936170213,0.265957446808511,0.159574468085106,0.255319148936170;0.296296296296296,0.244444444444444,0.162962962962963,0.296296296296296;0.276595744680851,0.228723404255319,0.159574468085106,0.335106382978723;0.258823529411765,0.215686274509804,0.235294117647059,0.290196078431373;0.242603550295858,0.239644970414201,0.295857988165681,0.221893491124260;0.229545454545455,0.370454545454546,0.229545454545455,0.170454545454545];


%GA
% lambda_f =10   u_f = 10   ut=25/50
count_prob1=[0.375000000000000,0.275000000000000,0.175000000000000,0.175000000000000;0.349206349206349,0.253968253968254,0.174603174603175,0.222222222222222;0.319148936170213,0.244680851063830,0.170212765957447,0.265957446808511;0.296296296296296,0.229629629629630,0.170370370370370,0.303703703703704;0.276595744680851,0.218085106382979,0.164893617021277,0.340425531914894;0.258823529411765,0.207843137254902,0.160784313725490,0.372549019607843;0.242603550295858,0.198224852071006,0.275147928994083,0.284023668639053;0.229545454545455,0.188636363636364,0.363636363636364,0.218181818181818];
% count_prob2=[0.375000000000000,0.275000000000000,0.175000000000000,0.175000000000000;0.349206349206349,0.253968253968254,0.174603174603175,0.222222222222222;0.319148936170213,0.244680851063830,0.170212765957447,0.265957446808511;0.296296296296296,0.229629629629630,0.170370370370370,0.303703703703704;0.276595744680851,0.218085106382979,0.164893617021277,0.340425531914894;0.258823529411765,0.207843137254902,0.160784313725490,0.372549019607843;0.242603550295858,0.198224852071006,0.275147928994083,0.284023668639053;0.229545454545455,0.188636363636364,0.363636363636364,0.218181818181818];

u_t=50;

i = 1;
for N = 5 : 12
    for a = 1 : 3
        [lambda_t,T_save,D_access,T_process]=satu_delay1(N,a,u_t);%N需要修改
        delay_sum(i,a)=(D_access+T_process)*1000;%ms
        expected_delay(i,1)=expected_delay(i,1)+count_prob(i,a+1)*delay_sum(i,a);
        delay_sum1(i,a)=(D_access+T_process)*1000;%ms
        expected_delay1(i,1)=expected_delay1(i,1)+count_prob1(i,a+1)*delay_sum1(i,a);
    end
    i = i + 1;
end

expected_delay
expected_delay1

figure
x = 5:1:12;
plot(x,expected_delay(:,1),'-or','linewidth',1.5);
hold on;
plot(x,expected_delay1(:,1),'-^b','linewidth',1.5);
hold on;
xlabel('Maximum number of vehicles in VFC system');
ylabel('Expected delay (ms)');
% axis([5 12 240 275]);
legend('SMDP','GA','Location','NorthWest');

